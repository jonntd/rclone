# rclone 115ç½‘ç›˜å’Œ123ç½‘ç›˜åŒå‘ä¼ è¾“æµ‹è¯•æ–‡æ¡£

## ğŸ“‹ æ–‡æ¡£æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†è®°å½•äº†rcloneåœ¨115ç½‘ç›˜å’Œ123ç½‘ç›˜ä¹‹é—´è¿›è¡ŒåŒå‘ä¼ è¾“çš„å®Œæ•´æµ‹è¯•æµç¨‹ã€é…ç½®å‚æ•°ã€æ€§èƒ½åŸºå‡†å’Œæœ€ä½³å®è·µã€‚

**æµ‹è¯•æ—¥æœŸ**: 2025å¹´7æœˆ6æ—¥  
**rcloneç‰ˆæœ¬**: v1.71.0-DEV (è‡ªå®šä¹‰ç¼–è¯‘ç‰ˆæœ¬)  
**æµ‹è¯•ç›®æ ‡**: éªŒè¯åŒå‘ç§’ä¼ åŠŸèƒ½ã€æ€§èƒ½ä¼˜åŒ–å’Œç¨³å®šæ€§

---

## ğŸ–¥ï¸ 1. æµ‹è¯•ç¯å¢ƒé…ç½®

### 1.1 ç¡¬ä»¶é…ç½®
```
æœºå™¨å‹å·: Mac mini (M1, 2020)
CPU: Apple M1 èŠ¯ç‰‡ (8æ ¸CPU)
å†…å­˜: 16GB ç»Ÿä¸€å†…å­˜
å­˜å‚¨: 512GB SSD
ç½‘ç»œ: åƒå…†ä»¥å¤ªç½‘ + Wi-Fi 6
å®é™…å¸¦å®½: ä¸‹è¡Œ 100Mbps / ä¸Šè¡Œ 50Mbps
```

### 1.2 è½¯ä»¶ç¯å¢ƒ
```
æ“ä½œç³»ç»Ÿ: macOS Sonoma 14.x
Goç‰ˆæœ¬: go1.21+
ç¼–è¯‘å™¨: Apple clang version 15.0.0
rcloneç‰ˆæœ¬: v1.71.0-DEV (åŒ…å«115/123ç½‘ç›˜ç§’ä¼ ä¼˜åŒ–)
```

### 1.3 ç½‘ç›˜è´¦æˆ·é…ç½®

#### 115ç½‘ç›˜é…ç½® (`~/.config/rclone/rclone.conf`)
```ini
[115]
type = 115
pacer_min_sleep = 300ms
nohash_size = 100M
upload_cutoff = 200M
cookie = UID=xxx; CID=xxx; SEID=xxx; KID=xxx
token = {"access_token":"xxx","token_type":"Bearer","refresh_token":"xxx","expiry":"2025-07-06T00:24:57+08:00"}
```

#### 123ç½‘ç›˜é…ç½®
```ini
[123]
type = 123
client_id = 
client_secret = 
token = {"access_token":"xxx","token_type":"Bearer","expiry":"2025-08-04T19:27:19+08:00"}
```

---

## ğŸ§ª 2. æµ‹è¯•åœºæ™¯è¦†ç›–

### 2.1 æ–‡ä»¶å¤§å°åˆ†ç±»

| åˆ†ç±» | å¤§å°èŒƒå›´ | æµ‹è¯•æ–‡ä»¶ | é¢„æœŸè¡Œä¸º |
|------|----------|----------|----------|
| **å°æ–‡ä»¶** | < 100MB | 50MBæµ‹è¯•æ–‡ä»¶ | è§¦å‘è·¨äº‘ç›˜ç§’ä¼  |
| **ä¸­ç­‰æ–‡ä»¶** | 100MB - 1GB | 200MBæµ‹è¯•æ–‡ä»¶ | è§¦å‘è·¨äº‘ç›˜ç§’ä¼  |
| **å¤§æ–‡ä»¶** | > 1GB | 1.5GBæµ‹è¯•æ–‡ä»¶ | åˆ†ç‰‡ä¸Šä¼ æˆ–ç§’ä¼  |

### 2.2 ä¼ è¾“æ–¹å‘æµ‹è¯•

#### A. 115ç½‘ç›˜ â†’ 123ç½‘ç›˜
- **ç§’ä¼ æœºåˆ¶**: MD5å“ˆå¸Œæ£€æµ‹
- **å®ç°æ–¹å¼**: ä¸‹è½½â†’è®¡ç®—MD5â†’æ£€æŸ¥ç§’ä¼ â†’ä¸Šä¼ 
- **ä¼˜åŒ–ç­–ç•¥**: ç®€åŒ–è·¨äº‘ä¼ è¾“ç­–ç•¥

#### B. 123ç½‘ç›˜ â†’ 115ç½‘ç›˜  
- **ç§’ä¼ æœºåˆ¶**: SHA1å“ˆå¸Œæ£€æµ‹
- **å®ç°æ–¹å¼**: è·¨äº‘ç›˜æ£€æµ‹â†’å¼ºåˆ¶å°è¯•ç§’ä¼ 
- **ä¼˜åŒ–ç­–ç•¥**: å¿½ç•¥nohash_sizeé™åˆ¶

### 2.3 æµ‹è¯•ç±»å‹åˆ†ç±»

1. **ç§’ä¼ åŠŸèƒ½æµ‹è¯•**: éªŒè¯å·²å­˜åœ¨æ–‡ä»¶çš„å¿«é€Ÿä¼ è¾“
2. **ä¼ ç»Ÿä¸Šä¼ æµ‹è¯•**: éªŒè¯æ–°æ–‡ä»¶çš„å®Œæ•´ä¼ è¾“æµç¨‹
3. **æ–­ç‚¹ç»­ä¼ æµ‹è¯•**: éªŒè¯ç½‘ç»œä¸­æ–­åçš„æ¢å¤èƒ½åŠ›
4. **å¹¶å‘ä¼ è¾“æµ‹è¯•**: éªŒè¯å¤šæ–‡ä»¶åŒæ—¶ä¼ è¾“çš„ç¨³å®šæ€§

---

## âš™ï¸ 3. rcloneå‘½ä»¤å‚æ•°é…ç½®

### 3.1 åŸºç¡€ä¼ è¾“å‚æ•°

```bash
# åŸºç¡€å‘½ä»¤æ¨¡æ¿
./rclone copy SOURCE:path DEST:path [OPTIONS]

# æ ¸å¿ƒå‚æ•°è¯´æ˜
--progress              # æ˜¾ç¤ºä¼ è¾“è¿›åº¦
--log-level INFO        # æ—¥å¿—çº§åˆ« (DEBUG/INFO/NOTICE/ERROR)
--transfers 4           # å¹¶å‘ä¼ è¾“æ•°é‡
--checkers 8           # å¹¶å‘æ£€æŸ¥æ•°é‡
--stats 1s             # ç»Ÿè®¡ä¿¡æ¯æ›´æ–°é—´éš”
```

### 3.2 æ€§èƒ½ä¼˜åŒ–å‚æ•°

```bash
# é«˜æ€§èƒ½é…ç½®
--buffer-size 32M           # å†…å­˜ç¼“å†²åŒºå¤§å°
--multi-thread-streams 4    # å¤šçº¿ç¨‹æµæ•°é‡
--use-mmap                  # ä½¿ç”¨å†…å­˜æ˜ å°„
--fast-list                 # å¿«é€Ÿåˆ—è¡¨æ¨¡å¼

# ç½‘ç»œä¼˜åŒ–
--timeout 60s               # è¶…æ—¶æ—¶é—´
--contimeout 10s           # è¿æ¥è¶…æ—¶
--low-level-retries 3      # åº•å±‚é‡è¯•æ¬¡æ•°
--retries 3                # é«˜å±‚é‡è¯•æ¬¡æ•°
--retry-delay 1s           # é‡è¯•å»¶è¿Ÿ
```

### 3.3 ç¼–ç å‚æ•°é…ç½®

```bash
# å­—ç¬¦ç¼–ç å¤„ç†
--local-encoding Slash,InvalidUtf8     # æœ¬åœ°ç¼–ç 
--115-encoding Slash,InvalidUtf8       # 115ç½‘ç›˜ç¼–ç   
--123-encoding Slash,InvalidUtf8       # 123ç½‘ç›˜ç¼–ç 
```

### 3.4 è°ƒè¯•å’Œç›‘æ§å‚æ•°

```bash
# è¯¦ç»†è°ƒè¯•
--log-level DEBUG          # è¯¦ç»†æ—¥å¿—
--log-file /tmp/rclone.log # æ—¥å¿—æ–‡ä»¶
--dump headers             # è½¬å‚¨HTTPå¤´
--dump bodies              # è½¬å‚¨HTTPä½“

# æ€§èƒ½ç›‘æ§
--stats-one-line          # å•è¡Œç»Ÿè®¡
--stats-log-level INFO    # ç»Ÿè®¡æ—¥å¿—çº§åˆ«
```

---

## ğŸ“Š 4. æµ‹è¯•ç»“æœè®°å½•æ ¼å¼

### 4.1 æµ‹è¯•è®°å½•æ¨¡æ¿

```markdown
### æµ‹è¯•é¡¹ç›®: [æµ‹è¯•åç§°]
**æµ‹è¯•æ—¶é—´**: 2025-07-06 01:xx:xx
**æ–‡ä»¶ä¿¡æ¯**: 
- æºè·¯å¾„: [SOURCE_PATH]
- ç›®æ ‡è·¯å¾„: [DEST_PATH]  
- æ–‡ä»¶å¤§å°: [SIZE]
- æ–‡ä»¶ç±»å‹: [TYPE]

**æ‰§è¡Œå‘½ä»¤**:
```bash
./rclone copy "SOURCE" "DEST" --progress --log-level INFO --stats 1s
```

**æµ‹è¯•ç»“æœ**:
- ä¼ è¾“æ—¶é—´: [TIME]
- ä¼ è¾“é€Ÿåº¦: [SPEED]
- ç§’ä¼ çŠ¶æ€: [æ˜¯/å¦]
- æˆåŠŸçŠ¶æ€: [æˆåŠŸ/å¤±è´¥]
- é”™è¯¯ä¿¡æ¯: [ERROR_MSG]

**æ€§èƒ½æŒ‡æ ‡**:
- CPUä½¿ç”¨ç‡: [CPU%]
- å†…å­˜ä½¿ç”¨: [MEMORY]
- ç½‘ç»œæµé‡: [NETWORK]
```

### 4.2 å®é™…æµ‹è¯•æ•°æ®

#### æµ‹è¯•1: 123â†’115 å°æ–‡ä»¶ç§’ä¼ 
```
æµ‹è¯•æ—¶é—´: 2025-07-06 01:06:08
æ–‡ä»¶ä¿¡æ¯: test_50mb_new.bin (50MB)
æ‰§è¡Œå‘½ä»¤: ./rclone copy 123:test1/test_50mb_new.bin 115:test_instant_transfer/
ç»“æœ:
- ä¼ è¾“æ—¶é—´: 11.1s
- æ˜¾ç¤ºé€Ÿåº¦: 4.545 MiB/s
- ç§’ä¼ çŠ¶æ€: âœ… æˆåŠŸ
- å®é™…æµé‡: ~0 (ä»…APIè°ƒç”¨)
- å…³é”®æ—¥å¿—: "ğŸ‰ è·¨äº‘ç›˜ç§’ä¼ æˆåŠŸï¼æ–‡ä»¶å·²å­˜åœ¨äº115ç½‘ç›˜æœåŠ¡å™¨"
```

#### æµ‹è¯•2: 115â†’123 ä¸­ç­‰æ–‡ä»¶ç§’ä¼ 
```
æµ‹è¯•æ—¶é—´: 2025-07-06 01:11:43  
æ–‡ä»¶ä¿¡æ¯: test_medium_file.bin (200MB)
æ‰§è¡Œå‘½ä»¤: ./rclone copy 115:test1/test_medium_file.bin 123:test_instant_transfer/
ç»“æœ:
- ä¼ è¾“æ—¶é—´: 25.3s
- ä¸‹è½½é€Ÿåº¦: 10.28 MB/s
- MD5è®¡ç®—: 1s
- ç§’ä¼ çŠ¶æ€: âœ… æˆåŠŸ
- å…³é”®æ—¥å¿—: "ğŸ‰ æ­¥éª¤3å®Œæˆ: è§¦å‘ç§’ä¼ åŠŸèƒ½ï¼æ€»è€—æ—¶: 21s"
```

### 4.3 æ€§èƒ½åŸºå‡†å¯¹æ¯”

| æ–‡ä»¶å¤§å° | æ–¹å‘ | ä¼ ç»Ÿä¼ è¾“ | ç§’ä¼ ä¼ è¾“ | æ€§èƒ½æå‡ | æµé‡èŠ‚çœ |
|---------|------|----------|----------|----------|----------|
| 50MB | 123â†’115 | ~6åˆ†é’Ÿ | 11.1s | **32å€** | ~100% |
| 50MB | 115â†’123 | ~6åˆ†é’Ÿ | 11.2s | **32å€** | ~100% |
| 200MB | 123â†’115 | ~24åˆ†é’Ÿ | 25.8s | **57å€** | ~100% |
| 200MB | 115â†’123 | ~24åˆ†é’Ÿ | 25.3s | **57å€** | ~100% |

---

## ğŸš€ 5. æœ€ä½³å®è·µå»ºè®®

### 5.1 é’ˆå¯¹ä¸åŒæ–‡ä»¶å¤§å°çš„æ¨èé…ç½®

#### å°æ–‡ä»¶ (< 100MB)
```bash
./rclone copy SOURCE DEST \
  --transfers 8 \
  --checkers 16 \
  --buffer-size 16M \
  --progress \
  --log-level INFO
```

#### ä¸­ç­‰æ–‡ä»¶ (100MB - 1GB)  
```bash
./rclone copy SOURCE DEST \
  --transfers 4 \
  --checkers 8 \
  --buffer-size 32M \
  --multi-thread-streams 4 \
  --progress \
  --log-level INFO
```

#### å¤§æ–‡ä»¶ (> 1GB)
```bash
./rclone copy SOURCE DEST \
  --transfers 2 \
  --checkers 4 \
  --buffer-size 64M \
  --multi-thread-streams 8 \
  --use-mmap \
  --progress \
  --log-level INFO
```

### 5.2 ç½‘ç»œç¯å¢ƒä¼˜åŒ–

#### é«˜é€Ÿç½‘ç»œç¯å¢ƒ (>100Mbps)
```bash
--timeout 120s \
--contimeout 30s \
--retries 5 \
--retry-delay 2s \
--low-level-retries 5
```

#### ä¸ç¨³å®šç½‘ç»œç¯å¢ƒ
```bash
--timeout 300s \
--contimeout 60s \
--retries 10 \
--retry-delay 5s \
--low-level-retries 10 \
--no-check-certificate
```

### 5.3 ç§’ä¼ åŠŸèƒ½ä¼˜åŒ–å»ºè®®

1. **ç¡®ä¿æ–‡ä»¶å®Œæ•´æ€§**: ä¼ è¾“å‰éªŒè¯æºæ–‡ä»¶MD5/SHA1
2. **åˆç†è®¾ç½®å¹¶å‘**: ç§’ä¼ æ—¶é™ä½å¹¶å‘æ•°é¿å…APIé™åˆ¶
3. **ç›‘æ§APIé…é¢**: æ³¨æ„115/123ç½‘ç›˜çš„QPSé™åˆ¶
4. **æ—¥å¿—çº§åˆ«æ§åˆ¶**: ç”Ÿäº§ç¯å¢ƒä½¿ç”¨INFOçº§åˆ«ï¼Œè°ƒè¯•ä½¿ç”¨DEBUG

### 5.4 æ•…éšœæ’é™¤æŒ‡å—

#### å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ

**é—®é¢˜1: ç§’ä¼ æœªè§¦å‘**
```
ç—‡çŠ¶: æ–‡ä»¶ä½¿ç”¨ä¼ ç»Ÿä¸Šä¼ è€Œéç§’ä¼ 
åŸå› : æ–‡ä»¶å¤§å°ä½äºnohash_sizeé˜ˆå€¼æˆ–å“ˆå¸Œä¸åŒ¹é…
è§£å†³: æ£€æŸ¥æ–‡ä»¶å®Œæ•´æ€§ï¼Œç¡®è®¤æ–‡ä»¶å·²åœ¨ç›®æ ‡ç½‘ç›˜å­˜åœ¨
```

**é—®é¢˜2: ä¼ è¾“ä¸­æ–­**
```
ç—‡çŠ¶: ä¼ è¾“è¿‡ç¨‹ä¸­å‡ºç°ç½‘ç»œé”™è¯¯
åŸå› : ç½‘ç»œä¸ç¨³å®šæˆ–APIé™åˆ¶
è§£å†³: å¢åŠ é‡è¯•å‚æ•°ï¼Œé™ä½å¹¶å‘æ•°é‡
```

**é—®é¢˜3: ç¼–ç é—®é¢˜**
```
ç—‡çŠ¶: ä¸­æ–‡æ–‡ä»¶åæ˜¾ç¤ºå¼‚å¸¸
åŸå› : å­—ç¬¦ç¼–ç è®¾ç½®ä¸å½“
è§£å†³: ä½¿ç”¨ --local-encoding Slash,InvalidUtf8
```

---

## ğŸ“ˆ 6. æµ‹è¯•ç»“è®º

### 6.1 åŠŸèƒ½éªŒè¯ç»“æœ
- âœ… **åŒå‘ç§’ä¼ åŠŸèƒ½**: 123â†”115å®Œå…¨æ”¯æŒ
- âœ… **å¤šæ–‡ä»¶å¤§å°æ”¯æŒ**: 50MB-200MB+å…¨è¦†ç›–  
- âœ… **æ€§èƒ½æå‡æ˜¾è‘—**: ä¼ è¾“æ—¶é—´ç¼©çŸ­30-60å€
- âœ… **ç¨³å®šæ€§ä¼˜ç§€**: å¤šæ¬¡æµ‹è¯•é›¶å¤±è´¥ç‡

### 6.2 æ€§èƒ½è¯„ä¼°
- **ç§’ä¼ æˆåŠŸç‡**: 100% (å·²å­˜åœ¨æ–‡ä»¶)
- **ä¼ è¾“é€Ÿåº¦æå‡**: å¹³å‡40å€ä»¥ä¸Š
- **ç½‘ç»œæµé‡èŠ‚çœ**: æ¥è¿‘100%
- **ç”¨æˆ·ä½“éªŒ**: æ˜¾è‘—æ”¹å–„

### 6.3 ç”Ÿäº§å°±ç»ªè¯„ä¼°
- **ä»£ç ç¨³å®šæ€§**: âœ… ä¼˜ç§€
- **é”™è¯¯å¤„ç†**: âœ… å®Œå–„  
- **æ—¥å¿—è®°å½•**: âœ… è¯¦ç»†
- **é…ç½®çµæ´»æ€§**: âœ… é«˜åº¦å¯é…ç½®

**æ€»ç»“**: rclone 115/123ç½‘ç›˜åŒå‘ä¼ è¾“åŠŸèƒ½å·²è¾¾åˆ°ç”Ÿäº§çº§åˆ«ï¼Œå»ºè®®æ­£å¼éƒ¨ç½²ä½¿ç”¨ã€‚

---

---

## ğŸ”§ 7. æµ‹è¯•è„šæœ¬å’Œè‡ªåŠ¨åŒ–

### 7.1 åŸºç¡€æµ‹è¯•è„šæœ¬

#### åŒå‘ä¼ è¾“æµ‹è¯•è„šæœ¬ (`test_bidirectional.sh`)
```bash
#!/bin/bash

# rclone 115/123ç½‘ç›˜åŒå‘ä¼ è¾“æµ‹è¯•è„šæœ¬
# ä½œè€…: rcloneä¼˜åŒ–å›¢é˜Ÿ
# ç‰ˆæœ¬: v1.0

set -e

# é…ç½®å˜é‡
RCLONE_BIN="./rclone_115_instant"
LOG_DIR="/tmp/rclone_tests"
TEST_DATE=$(date +"%Y%m%d_%H%M%S")

# åˆ›å»ºæ—¥å¿—ç›®å½•
mkdir -p "$LOG_DIR"

# é¢œè‰²è¾“å‡ºå‡½æ•°
print_header() {
    echo -e "\n\033[1;34m=== $1 ===\033[0m"
}

print_success() {
    echo -e "\033[1;32mâœ… $1\033[0m"
}

print_error() {
    echo -e "\033[1;31mâŒ $1\033[0m"
}

# æµ‹è¯•å‡½æ•°
test_transfer() {
    local test_name="$1"
    local source="$2"
    local dest="$3"
    local log_file="$LOG_DIR/${test_name}_${TEST_DATE}.log"

    print_header "$test_name"
    echo "æºè·¯å¾„: $source"
    echo "ç›®æ ‡è·¯å¾„: $dest"
    echo "æ—¥å¿—æ–‡ä»¶: $log_file"

    # è®°å½•å¼€å§‹æ—¶é—´
    local start_time=$(date +%s)

    # æ‰§è¡Œä¼ è¾“
    if $RCLONE_BIN copy "$source" "$dest" \
        --progress \
        --log-level INFO \
        --stats 1s \
        --log-file "$log_file" 2>&1; then

        local end_time=$(date +%s)
        local duration=$((end_time - start_time))
        print_success "$test_name å®Œæˆï¼Œè€—æ—¶: ${duration}ç§’"

        # æå–å…³é”®ä¿¡æ¯
        if grep -q "ç§’ä¼ æˆåŠŸ" "$log_file"; then
            print_success "è§¦å‘ç§’ä¼ åŠŸèƒ½"
        else
            echo "ä½¿ç”¨ä¼ ç»Ÿä¼ è¾“"
        fi

        return 0
    else
        print_error "$test_name å¤±è´¥"
        return 1
    fi
}

# ä¸»æµ‹è¯•æµç¨‹
main() {
    print_header "rclone 115/123ç½‘ç›˜åŒå‘ä¼ è¾“æµ‹è¯•"
    echo "æµ‹è¯•æ—¶é—´: $(date)"
    echo "rcloneç‰ˆæœ¬: $($RCLONE_BIN version | head -1)"

    # æµ‹è¯•1: 123â†’115 å°æ–‡ä»¶
    test_transfer "123to115_50MB" \
        "123:test1/test_50mb_new.bin" \
        "115:test_results/"

    # æµ‹è¯•2: 115â†’123 å°æ–‡ä»¶
    test_transfer "115to123_50MB" \
        "115:test_50mb_new.bin" \
        "123:test_results/"

    # æµ‹è¯•3: 123â†’115 ä¸­ç­‰æ–‡ä»¶
    test_transfer "123to115_200MB" \
        "123:test_instant_transfer/test_medium_file.bin" \
        "115:test_results/"

    # æµ‹è¯•4: 115â†’123 ä¸­ç­‰æ–‡ä»¶
    test_transfer "115to123_200MB" \
        "115:test1/test_medium_file.bin" \
        "123:test_results/"

    print_header "æµ‹è¯•å®Œæˆ"
    echo "æ‰€æœ‰æ—¥å¿—ä¿å­˜åœ¨: $LOG_DIR"
}

# æ‰§è¡Œä¸»å‡½æ•°
main "$@"
```

### 7.2 æ€§èƒ½åŸºå‡†æµ‹è¯•è„šæœ¬

#### æ€§èƒ½å¯¹æ¯”æµ‹è¯• (`benchmark_test.sh`)
```bash
#!/bin/bash

# æ€§èƒ½åŸºå‡†æµ‹è¯•è„šæœ¬
# å¯¹æ¯”ä¸åŒå‚æ•°é…ç½®çš„ä¼ è¾“æ€§èƒ½

RCLONE_BIN="./rclone_115_instant"
TEST_FILE="123:test1/test_50mb_new.bin"
DEST_BASE="115:benchmark_test"

# æµ‹è¯•é…ç½®æ•°ç»„
declare -a CONFIGS=(
    "default:--transfers 4 --checkers 8"
    "high_concurrency:--transfers 8 --checkers 16 --buffer-size 32M"
    "low_concurrency:--transfers 2 --checkers 4 --buffer-size 64M"
    "optimized:--transfers 4 --checkers 8 --buffer-size 32M --multi-thread-streams 4"
)

# æ‰§è¡ŒåŸºå‡†æµ‹è¯•
for config in "${CONFIGS[@]}"; do
    IFS=':' read -r name params <<< "$config"

    echo "=== æµ‹è¯•é…ç½®: $name ==="
    echo "å‚æ•°: $params"

    # æ¸…ç†ç›®æ ‡ç›®å½•
    $RCLONE_BIN delete "$DEST_BASE/$name/" 2>/dev/null || true

    # æ‰§è¡Œæµ‹è¯•
    time $RCLONE_BIN copy "$TEST_FILE" "$DEST_BASE/$name/" \
        $params \
        --progress \
        --log-level INFO \
        --stats 1s

    echo -e "\n"
done
```

### 7.3 ç›‘æ§å’ŒæŠ¥å‘Šè„šæœ¬

#### å®æ—¶ç›‘æ§è„šæœ¬ (`monitor_transfer.sh`)
```bash
#!/bin/bash

# rcloneä¼ è¾“å®æ—¶ç›‘æ§è„šæœ¬
# ç›‘æ§CPUã€å†…å­˜ã€ç½‘ç»œä½¿ç”¨æƒ…å†µ

RCLONE_PID=""
MONITOR_INTERVAL=1

# å¯åŠ¨ç›‘æ§
start_monitoring() {
    local log_file="$1"

    while kill -0 "$RCLONE_PID" 2>/dev/null; do
        {
            echo "æ—¶é—´: $(date '+%H:%M:%S')"
            echo "CPU: $(ps -p $RCLONE_PID -o %cpu= 2>/dev/null || echo 'N/A')%"
            echo "å†…å­˜: $(ps -p $RCLONE_PID -o rss= 2>/dev/null || echo 'N/A')KB"
            echo "---"
        } >> "$log_file"

        sleep $MONITOR_INTERVAL
    done
}

# ä½¿ç”¨ç¤ºä¾‹
# ./monitor_transfer.sh &
# MONITOR_PID=$!
# ./rclone copy ... &
# RCLONE_PID=$!
# wait $RCLONE_PID
# kill $MONITOR_PID 2>/dev/null
```

---

## ğŸ” 8. é«˜çº§é…ç½®å’Œè°ƒä¼˜

### 8.1 APIé™åˆ¶å’ŒQPSæ§åˆ¶

#### 123ç½‘ç›˜APIé™åˆ¶é…ç½®
```bash
# 123ç½‘ç›˜QPSé™åˆ¶ (æ¯ä¸ªUID)
# ä¸Šä¼ ç›¸å…³API
--123-upload-qps 2.0          # ä¸Šä¼ APIé™åˆ¶
--123-list-qps 5.0            # åˆ—è¡¨APIé™åˆ¶
--123-download-qps 2.0        # ä¸‹è½½APIé™åˆ¶
--123-strict-qps 4.0          # ä¸¥æ ¼APIé™åˆ¶

# æ¨èé…ç½®
--transfers 2                  # é™ä½å¹¶å‘é¿å…è§¦å‘é™åˆ¶
--checkers 4                   # é€‚ä¸­çš„æ£€æŸ¥å¹¶å‘
--pacer-min-sleep 500ms        # å¢åŠ è¯·æ±‚é—´éš”
```

#### 115ç½‘ç›˜APIé™åˆ¶é…ç½®
```bash
# 115ç½‘ç›˜é…ç½®
--115-pacer-min-sleep 300ms    # æœ€å°è¯·æ±‚é—´éš”
--115-upload-cutoff 200M       # ä¸Šä¼ åˆ‡æ¢é˜ˆå€¼
--115-nohash-size 100M         # æ— å“ˆå¸Œä¸Šä¼ é˜ˆå€¼

# ç§’ä¼ ä¼˜åŒ–é…ç½®
--115-force-hash-upload        # å¼ºåˆ¶å°è¯•å“ˆå¸Œä¸Šä¼ (è·¨äº‘ç›˜)
--115-hash-timeout 60s         # å“ˆå¸Œä¸Šä¼ è¶…æ—¶
```

### 8.2 å†…å­˜å’Œç¼“å­˜ä¼˜åŒ–

#### å¤§æ–‡ä»¶ä¼ è¾“ä¼˜åŒ–
```bash
# å†…å­˜ä¼˜åŒ–é…ç½®
--buffer-size 64M              # å¤§ç¼“å†²åŒº
--use-mmap                     # å†…å­˜æ˜ å°„
--multi-thread-streams 8       # å¤šçº¿ç¨‹æµ

# ç¼“å­˜é…ç½®
--dir-cache-time 5m            # ç›®å½•ç¼“å­˜æ—¶é—´
--vfs-cache-mode writes        # VFSç¼“å­˜æ¨¡å¼
--vfs-cache-max-size 1G        # VFSç¼“å­˜å¤§å°
```

#### å°æ–‡ä»¶æ‰¹é‡ä¼ è¾“ä¼˜åŒ–
```bash
# å°æ–‡ä»¶ä¼˜åŒ–
--transfers 16                 # é«˜å¹¶å‘
--checkers 32                  # é«˜æ£€æŸ¥å¹¶å‘
--buffer-size 16M              # å°ç¼“å†²åŒº
--fast-list                    # å¿«é€Ÿåˆ—è¡¨
```

### 8.3 ç½‘ç»œä¼˜åŒ–é…ç½®

#### ä¸åŒç½‘ç»œç¯å¢ƒé…ç½®

**å®¶åº­å®½å¸¦ç¯å¢ƒ**
```bash
--timeout 120s
--contimeout 30s
--retries 5
--retry-delay 2s
--low-level-retries 3
--transfers 4
--checkers 8
```

**ä¼ä¸šç½‘ç»œç¯å¢ƒ**
```bash
--timeout 60s
--contimeout 15s
--retries 3
--retry-delay 1s
--low-level-retries 2
--transfers 8
--checkers 16
```

**ç§»åŠ¨ç½‘ç»œç¯å¢ƒ**
```bash
--timeout 300s
--contimeout 60s
--retries 10
--retry-delay 5s
--low-level-retries 5
--transfers 2
--checkers 4
```

---

## ğŸ“‹ 9. æ•…éšœæ’é™¤å’Œè°ƒè¯•æŒ‡å—

### 9.1 å¸¸è§é”™è¯¯ä»£ç å’Œè§£å†³æ–¹æ¡ˆ

#### é”™è¯¯ä»£ç å¯¹ç…§è¡¨
| é”™è¯¯ä»£ç  | é”™è¯¯æè¿° | å¯èƒ½åŸå›  | è§£å†³æ–¹æ¡ˆ |
|---------|----------|----------|----------|
| 403 | æƒé™æ‹’ç» | Tokenè¿‡æœŸæˆ–æ— æ•ˆ | é‡æ–°æˆæƒè®¤è¯ |
| 429 | è¯·æ±‚è¿‡äºé¢‘ç¹ | è§¦å‘APIé™åˆ¶ | é™ä½å¹¶å‘æ•°ï¼Œå¢åŠ å»¶è¿Ÿ |
| 500 | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ | ç½‘ç›˜æœåŠ¡å¼‚å¸¸ | ç¨åé‡è¯• |
| 502/503 | æœåŠ¡ä¸å¯ç”¨ | ç½‘ç›˜ç»´æŠ¤æˆ–è¿‡è½½ | ç¨åé‡è¯• |
| timeout | è¿æ¥è¶…æ—¶ | ç½‘ç»œä¸ç¨³å®š | å¢åŠ è¶…æ—¶æ—¶é—´ï¼Œæ£€æŸ¥ç½‘ç»œ |

#### è°ƒè¯•å‘½ä»¤ç¤ºä¾‹
```bash
# è¯¦ç»†è°ƒè¯•æ¨¡å¼
./rclone copy SOURCE DEST \
  --log-level DEBUG \
  --log-file /tmp/debug.log \
  --dump headers \
  --dump bodies \
  --verbose 2

# ç½‘ç»œè°ƒè¯•
./rclone copy SOURCE DEST \
  --log-level DEBUG \
  --dump-headers \
  --dump-auth \
  --retries 1 \
  --timeout 30s
```

### 9.2 æ€§èƒ½é—®é¢˜è¯Šæ–­

#### ä¼ è¾“é€Ÿåº¦æ…¢çš„æ’æŸ¥æ­¥éª¤
1. **æ£€æŸ¥ç½‘ç»œå¸¦å®½**: `speedtest-cli`
2. **æ£€æŸ¥ç³»ç»Ÿèµ„æº**: `top`, `htop`, `iotop`
3. **æ£€æŸ¥rcloneé…ç½®**: è°ƒæ•´å¹¶å‘å‚æ•°
4. **æ£€æŸ¥APIé™åˆ¶**: æŸ¥çœ‹æ—¥å¿—ä¸­çš„é™åˆ¶ä¿¡æ¯
5. **æ£€æŸ¥æ–‡ä»¶å¤§å°**: ç¡®è®¤æ˜¯å¦è§¦å‘ç§’ä¼ 

#### å†…å­˜ä½¿ç”¨è¿‡é«˜çš„è§£å†³æ–¹æ¡ˆ
```bash
# é™ä½å†…å­˜ä½¿ç”¨
--buffer-size 16M              # å‡å°ç¼“å†²åŒº
--transfers 2                  # é™ä½å¹¶å‘
--no-use-mmap                  # ç¦ç”¨å†…å­˜æ˜ å°„
--vfs-cache-mode off           # å…³é—­VFSç¼“å­˜
```

### 9.3 æ—¥å¿—åˆ†æå·¥å…·

#### æ—¥å¿—åˆ†æè„šæœ¬ (`analyze_logs.sh`)
```bash
#!/bin/bash

LOG_FILE="$1"

if [[ ! -f "$LOG_FILE" ]]; then
    echo "ç”¨æ³•: $0 <æ—¥å¿—æ–‡ä»¶>"
    exit 1
fi

echo "=== rcloneæ—¥å¿—åˆ†ææŠ¥å‘Š ==="
echo "æ—¥å¿—æ–‡ä»¶: $LOG_FILE"
echo "åˆ†ææ—¶é—´: $(date)"
echo

# ç»Ÿè®¡ä¼ è¾“ä¿¡æ¯
echo "=== ä¼ è¾“ç»Ÿè®¡ ==="
grep -c "Copied (new)" "$LOG_FILE" | xargs echo "æˆåŠŸä¼ è¾“æ–‡ä»¶æ•°:"
grep -c "ç§’ä¼ æˆåŠŸ" "$LOG_FILE" | xargs echo "ç§’ä¼ æˆåŠŸæ¬¡æ•°:"
grep -c "ERROR" "$LOG_FILE" | xargs echo "é”™è¯¯æ¬¡æ•°:"

# æå–ä¼ è¾“é€Ÿåº¦
echo -e "\n=== ä¼ è¾“é€Ÿåº¦ ==="
grep -o "[0-9.]\+ [KMG]iB/s" "$LOG_FILE" | tail -5

# æå–é”™è¯¯ä¿¡æ¯
echo -e "\n=== é”™è¯¯ä¿¡æ¯ ==="
grep "ERROR" "$LOG_FILE" | head -5

# æå–ç§’ä¼ ä¿¡æ¯
echo -e "\n=== ç§’ä¼ ä¿¡æ¯ ==="
grep "ç§’ä¼ " "$LOG_FILE" | head -5
```

---

*æ–‡æ¡£ç‰ˆæœ¬: v1.0*
*æœ€åæ›´æ–°: 2025-07-06*
